**An intrusion detection and prevention (IDS/IPS) architecture** is the structured framework outlining the roles, relationships, and communication conventions between machines, devices, applications, and processes involved in intrusion detection and prevention. An efficient architecture ensures effective coordination and information processing for appropriate preventive responses, aligning with an organization's operational and business requirements.

#### Tiered Architectures

There are three main types of tiered architectures:

- **Single-Tiered Architecture:** In a single-tiered architecture, components within an IDS or IPS handle data collection and processing independently without passing output to other components. An example is a host-based intrusion detection tool that analyzes system logs, comparing them to known attack patterns. This simple architecture offers advantages like low cost, simplicity, and independence from other components. However, it lacks sophisticated functionality and efficiency due to components operating in isolation.
    
- **Multi-Tiered Architecture:** Multi-tiered architecture involves multiple, hierarchically organized components that exchange information. Modern IDSs typically consist of three primary components: sensors, analyzers (or agents), and a manager.
    
    - **Sensors:** Sensors collect data from various sources, such as network interfaces, system logs, personal firewalls, and TCP wrappers. They pass this information to agents.
    - **Agents (Analyzers):** Agents, often specialized for specific functions, monitor intrusive activity on individual hosts, analyzing the data received from sensors. One agent might focus on TCP traffic, while another examines FTP connections. Third-party tools like network-monitoring tools, neural networks, and connection-tracing tools can extend analysis capabilities.
    - **Manager:** The manager component oversees centralized functions like:
        - **Event Correlation and Analysis:** Correlating data from multiple sensors and agents to identify complex attack patterns that might be missed by individual components.
        - **Reporting:** Generating comprehensive reports on security events, including the type, severity, and source of attacks, as well as the actions taken by the IDS/IPS.
        - **Policy Management:** Defining and enforcing security policies across the entire system.
        - **Alert Management:** Handling alerts generated by sensors and agents, including filtering, prioritizing, and escalating alerts based on their severity.
        - **Security Management:** Managing various security aspects of the IDS/IPS, including user authentication, access control, and system updates.
        - **Management Console:** Providing a centralized interface for operators to monitor and manage the entire IDS/IPS deployment.
- **Peer-to-Peer Architecture:** This architecture features multiple components, like firewalls, functioning as peers without hierarchical subordination. They collaborate and share information to detect and prevent intrusions.
    

### Sensor: Functions, Deployment, and Security

#### Sensor Functions

Sensors are fundamental to IDS/IPS architectures, initiating the detection process by collecting data on potentially malicious activity. There are two primary types:

- **Network-Based Sensors:** These sensors capture data from network interfaces, analyzing network traffic for suspicious patterns. They are crucial for detecting attacks targeting the network itself, such as denial-of-service attacks, port scans, and attempts to exploit network vulnerabilities.
- **Host-Based Sensors:** These sensors reside on individual hosts, monitoring events on that specific system. They analyze data from sources like system logs, application logs, and file system activity. This allows them to detect attacks that may not be visible at the network level, such as attempts to escalate privileges, install malware, or modify critical system files.

#### Sensor Deployment

Sensor placement is critical for effectiveness and depends on the type of sensor and the network environment.

- **Network-Based Sensor Placement:** Network-based sensors are typically positioned at strategic points in the network, such as:
    
    - **External gateways:** To monitor all traffic entering and leaving the network. This is crucial for detecting external attacks.
    - **Gateways to subnets or within VLANs:** To monitor traffic within specific network segments. This helps detect attacks targeting specific systems or applications.
    - **DMZ (Demilitarized Zone):** To monitor traffic in the DMZ, which is a network segment between the internal network and the external network. This helps detect attacks targeting servers and applications exposed to the internet.
- **Host-Based Sensor Placement:** Host-based sensors are deployed on individual hosts or devices. A hybrid approach, combining network-based sensors at various gateways and host-based sensors on critical servers, provides comprehensive coverage.
    

#### Sensor Security Considerations

- **Vulnerability to Attacks:** Sensors are frequent targets of attacks because they are often the first point of contact for malicious actors. Compromised sensors can lead to:
    
    - **Reduced Detection Rate:** Attackers can manipulate sensors to evade detection, leading to a decrease in the IDS/IPS system's effectiveness.
    - **False Data Injection:** Attackers can inject false data into the system, potentially triggering false alarms and diverting security resources.
    - **Denial-of-Service:** Attackers can flood sensors with traffic, overwhelming their resources and preventing them from functioning correctly.
    - **System Compromise:** Compromised sensors can be leveraged to gain access to other parts of the network, potentially leading to a complete system takeover.
- **Security Hardening:** Protecting sensors is crucial to maintain the integrity and effectiveness of the entire IDS/IPS system. Key security measures include:
    
    - **Hardening:** Tightening file permissions, restricting privileges, limiting access to the sensor system, minimizing running services, and installing security patches.
    - **Secure Communication:** Encrypting communication between sensors and other components to protect sensitive data.
    - **Component Independence:** Minimizing dependencies between components to limit the impact of a compromised sensor.
    - **Monitoring and Auditing:** Regularly monitoring sensor activity and logs to detect any signs of compromise.

By understanding the different types of IDS/IPS architectures and sensor deployments, security professionals can choose the best approach for their specific needs and effectively protect their networks from various threats.